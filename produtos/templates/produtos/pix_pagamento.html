{% extends 'produtos/base.html' %}
{% block content %}
<div class="row justify-content-center text-center">
    <div class="col-md-6">
        <h2 class="mb-3">Pagamento via Pix</h2>
        <p class="lead">Escaneie o QR Code abaixo ou copie a chave Pix para efetuar o pagamento.</p>
        
        <div class="card p-4 mb-4 shadow-sm">
            <div class="d-flex justify-content-center">
                <img src="data:image/png;base64,{{ pedido.pix_qr }}" 
                     alt="QR Code Pix" 
                     class="qr-code-img">
            </div>

            <p class="mt-3"><strong>Chave Pix:</strong> 
                <span id="chavePix">{{ pedido.pix_chave }}</span>
            </p>
            <p><strong>Valor:</strong> R$ {{ pedido.total|floatformat:2 }}</p>
            <button class="btn btn-primary" onclick="copiarChave()">Copiar chave Pix</button>
        </div>

        <a href="{% url 'lista_produtos' %}" class="btn btn-secondary mt-3">Voltar à loja</a>
        
        <h3 class="mt-4">Status do Pagamento:</h3>
        {% if pedido.pago %}
            <p style="color:green;">✅ Pago</p>
        {% else %}
            <p style="color:red;">⏳ Aguardando pagamento</p>
        {% endif %}
    </div>
</div>

<style>
.qr-code-img {
    width: 100%;
    aspect-ratio: 1/1;
    object-fit: contain;
    max-width: 250px; /* padrão celular */
}

@media (min-width: 768px) {
    .qr-code-img {
        max-width: 400px; /* tablet/notebook */
    }
}

@media (min-width: 1200px) {
    .qr-code-img {
        max-width: 500px; /* desktop grande */
    }
}
</style>

<script>
function copiarChave() {
    const chave = document.getElementById('chavePix').textContent;
    navigator.clipboard.writeText(chave).then(() => {
        alert('Chave Pix copiada para a área de transferência!');
    });
}
</script>
{% endblock %}
